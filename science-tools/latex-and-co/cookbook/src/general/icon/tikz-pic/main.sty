%%%
% src::
%     url = https://tex.stackexchange.com/a/749237/6880
%%%

%%%
% Notre boîte à outils pour des dessins vectoriels.
%%%
\usepackage{tikz}

%%%
% La macro ''\adjustbox'' du package éponyme permet d'adapter
% facilement les dimensions d'un matériel typrographique.
%%%
\usepackage{adjustbox}

%%%
% Les couleurs par défaut de l'enveloppe et des traits.
%%%
\definecolor{env-init-col}{RGB}{255, 207, 0}
\definecolor{line-init-col}{RGB}{0, 0, 0}

%%%
% La macro ''\kval'' donne la valeur associée à une clé \pgf.
%%%
\NewExpandableDocumentCommand{ \kval }{ m }{%
  \pgfkeysvalueof{/tikz/env-icon/#1}%
}

%%%
% Réglage général de certaines clés.
%%%
\tikzset{
%%%
% Il faut étendre la portée des clés afin que l'utilisateur puisse
% modifier leur valeur.
%%%
  env-icon/.search also = {/tikz, /pgf},
%%%
% Création de clés associés à env-icon.
%
% note::
%     L'emploi de ''env-icon/.cd'' fait changer de contexte, ceci
%     nous évitant de taper à chaque fois le contexte ''env-icon/''.
%%%
  env-icon/.cd,
    line-width/.initial    = 3pt,
    line-color/.initial    = line-init-col,
    corner-radius/.initial = 8pt,
    dot-radius/.initial    = 7pt,
    env-color/.initial     = env-init-col,
    seal-color/.initial    = env-init-col,
}

%%%
% La partie pénible de la recette est la création de l'icône
% au format vectoriel.
%%%
\tikzset{
%%%
% Création de différents styles.
%%%
  pre-common/.style = {
    draw       = \kval{line-color},
    line width = \kval{line-width}
  },
  full-common/.style = {
    pre-common,
    rounded corners = \kval{corner-radius}
  },
  env/.style = {
    full-common,
    fill = \kval{env-color}
  },
  flap/.style = {pre-common},
  seal-line/.style = {
    pre-common,
    fill = \kval{seal-color}
  },
  dot/.style = {
    circle,
    inner sep = \kval{dot-radius},
    draw      = \kval{line-color},
    fill      = \kval{line-color}
  },
%%%
% Notre icône sous forme de ''pic'' \tikz.
%%%
  PEC/.pic = {
% L'enveloppe.
    \draw[env]
      (0.9, 1  ) rectangle (4.2, 3.4);
    \draw[flap]
      (0.9, 2.8) -- (2.6, 1.7) -- (4.3, 2.8);
% Le sceau officiel.
    \draw[seal-line]
      (3.6, 1.4) coordinate (A)
      arc[
        start angle = 250,
        end angle   = -70,
        radius      = 8mm
      ]
      -- ++( 0, -.6)
      -- ++(-.25, .2)
      -- ++(-.25, -.2)
      -- cycle;
    \node [dot] at ([shift = (70:.8)]A) {};
  },
}


%%%
% prototype::
%     #1 : des options au format "clé-valeur". Voir le premier
%          ''\tikzset'' pour savoir ce qui est disponible.
%%%
\NewDocumentCommand{ \iconpec }{ O{} }{%
  \adjustbox{height=1.8ex}{%
    \tikzset{
      env-icon/.search also = {/tikz, /pgf},
      env-icon/.cd, #1
    }%
    \tikz{\pic{PEC};}%
  }%
}
