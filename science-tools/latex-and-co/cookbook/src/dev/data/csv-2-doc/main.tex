
\documentclass[varwidth, border = 3pt]{standalone}

\usepackage{main}

\usepackage{tabularray}

%%%
% Pour la gestion des unit√©s.
%%%
\usepackage{siunitx}

\ExplSyntaxOn

\cs_set:Npn \cookbook_csv_demo_start {
    \begin{tblr}
}

\cs_set:Npn \cookbook_csv_demo_end {
    \end{tblr}
}

\cs_set:Npn \cookbook_csv_demo:NN #1 #2 {
    \if_int_compare:w #1 = 1
        #1 &

    \else:
        #1 &
    \fi:
    
    //
}

\ExplSyntaxOff


\begin{document}

\ExplSyntaxOn

\ior_new:N \g_cookbook_csv_data_ior 

\int_new:N   \l_cookbook_csv_num_row_int
\clist_new:N \l_cookbook_csv_row_clist

\tl_new:N \l_cookbook_material_tl


\tl_clear:N \l_cookbook_material_tl

\ior_open:Nn 
  \g_cookbook_csv_data_ior 
  { data.csv }

\tl_put_right:No
  \l_cookbook_material_tl
  {\cookbook_csv_demo_start}



\int_zero:N \l_cookbook_csv_num_row_int

\ior_map_inline:Nn \g_cookbook_csv_data_ior {
  \int_incr:N \l_cookbook_csv_num_row_int
  
  \clist_clear:N \l_cookbook_csv_row_clist
  \clist_set:Nn  \l_cookbook_csv_row_clist {#1}

\tl_put_right:No
  \l_cookbook_material_tl
  {
    \cookbook_csv_demo:NN
      \l_cookbook_csv_num_row_int
      \l_cookbook_csv_row_clist
  }
}

\tl_put_right:No
  \l_cookbook_material_tl
  { \cookbook_csv_demo_end }

\ior_close:N \g_cookbook_csv_data_ior

\tl_show:N \l_cookbook_material_tl

\ExplSyntaxOff


\end{document}
