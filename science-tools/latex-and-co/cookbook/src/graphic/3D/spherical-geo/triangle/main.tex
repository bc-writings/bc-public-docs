% !TEX TS-program = lualatex

%%%
% src::
%     url = https://tex.stackexchange.com/a/751717/6880
%%%

\documentclass{standalone}

%%%
% Des couleurs faciles d'emploi via le package ''xcolor''!
%%%
\usepackage[svgnames]{xcolor}

%%%
% La bibliothèque ''luadraw'' allie une facilité d’utilisation à
% un rendu particulièrement soigné.
%%%
\usepackage[3d]{luadraw}

\begin{document}

\begin{luadraw}{name = spherical-triangle}
------
-- Importation du module ¨luadraw dédié à la ¨geo sphérique.
------
require 'luadraw_spherical'

------
-- ¨Def de la zone graphique.
------
local graphview = graph3d:new{
  window  = {-4, 4, -3, 5},
  viewdir = {25, 70},
  size    = {10, 10}
}

------
-- Réglages liés aux lignes et aux flèches.
------
graphview:Linewidth(6)
Hiddenlinestyle = "dashed"
Hiddenlines     = true

arrowBstyle = "-stealth"

------
-- Nos ¨objs de ¨geo sphérique.
------
local R =  3

local k  = R + 1
local kx = k + 2.75  -- Réglage empirique.

local O, N = Origin, sM(90, 0)

local A, B = sM(-50, 60), sM(-10, 60)
local C, D = sM(50, 70) , sM(170, 70)

graphview:Define_sphere({center = O, radius = R})

graphview:DSfacet(
  {N, A, B},
  {fill = "brown", fillopacity = 0.6}
)

graphview:DSfacet(
  {N, C, D},
  {fill = "brown", fillopacity = 0.6}
)

-- Axes du repère avec des ¨modifs au doigt mouillé pour
-- un meilleur design (cf. `kx`).
graphview:DSpolyline(
  {
    {O, kx * vecI},
    {O, k * vecJ},
    {O, k * vecK}},
    {arrows = 1, width = 6, color = "blue"}
)

-- Équateur.
graphview:DScircle(
  {O, vecK},       -- Plan du grand cercle.
  {color = "red"}
)

-- Tracé dans notre ¨geo sphérique.
graphview:Dspherical()

------
-- Ajout d'étiquettes.
------
graphview:Dlabel3d(
-- Points "cardinaux".
  "$N$", N, {pos = "NW"},
  "$O$", O, {pos = "S"},
-- Axes.
  "$x$", kx * vecI, {pos = "SW"},
  "$y$", k * vecJ , {pos = "E"},
  "$z$", k * vecK , {pos = "N"},
-- Points de l'exemple.
  "$A$", A, {pos = "S"},
  "$B$", B, {},
  "$C$", C, {pos = "E"},
  "$D$", D, {pos = "S"}
)

------
-- Et le merveilleux se révèle au monde.
------
graphview:Show()
\end{luadraw}

\end{document}
