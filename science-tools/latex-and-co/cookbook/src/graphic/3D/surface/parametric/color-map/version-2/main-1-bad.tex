% !TEX TS-program = lualatex

%%%
% src::
%     url = https://tex.stackexchange.com/a/646514/6880
%%%

\documentclass{standalone}

\usepackage[svgnames]{xcolor}
\usepackage[3d]{luadraw}

\begin{document}

\begin{luadraw}{name = param-surf-colmap-KO}
require 'luadraw_palettes'

local pal = getPal("Gnuplot")

local pi, sin, cos, tanh = math.pi, math.sin, math.cos, math.tanh

local graphview = graph3d:new{
  viewdir = {120, 55},
  bbox    = false
}

local projplane = surface(
  function(u, v)
    return M(
      2*(1 + cos(v))*cos(u),
      2*(1 + cos(v))*sin(u),
      2*sin(v)*tanh(u-pi)
    )
  end,
  0, 2*pi, 0,  2*pi,
  {51, 30}
)

graphview:Dpoly(
  facet2poly(projplane),
  {
    usepalette = {pal, "z"},
    mode       = mShadedOnly
  }
)


graphview:Show()
\end{luadraw}

\end{document}
