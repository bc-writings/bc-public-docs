% !TEX TS-program = lualatex

%%%
% src::
%   url = https://tex.stackexchange.com/a/751952/6880
%%%

\documentclass{standalone}

%%%
% Des couleurs nommées faciles d'emploi via le package ''xcolor''!
%%%
\usepackage[svgnames]{xcolor}

%%%
% La bibliothèque ''luadraw'' allie une facilité d’utilisation à
% un rendu particulièrement soigné.
%%%
\usepackage[3d]{luadraw}

\begin{document}

\begin{luadraw}{name = 3-sets}
------
-- ¨Def de la zone graphique.
------
local graphview = graph:new{
  window = {0, 16, 0, 4},
  margin = {0, 0, 0, 0}
}

------
-- Taille de la police des étiquettes.
------
graphview:Labelsize("footnotesize")

------
-- Nos ingrédients de base.
------
local i = cpx.I

local U = {
  -6 - 6*i, 6 - 6*i, 6 + 6*i, -6 + 6*i,
  "l",
  "cl"
}

local A = set(i, 0)
local B = set(-2 - i, 25)
local C = set(2 - i, -25)

-- Conversion des chemins en listes de complexes.
local C1, C2, C3 = path(A), path(B), path(C)

------
-- Deux fonctions de tracé pour factoriser le code.
------
local drawdiag = function(paths, legend)
  graphview:Dpolyline(
    paths,
    true,
       "draw = none,"
    .. "fill = lightgray,"
    .. "even odd rule"
  )

  graphview:Dpath(U)
  graphview:Dpath(A)
  graphview:Dpath(B)
  graphview:Dpath(C)

  graphview:Dlabel(
    "$U$", -6.5 + 6*i, {pos = "NE"},
    "$A$", 4.75*i, {pos = "N"},
    "$B$", -4 + 3*i, {pos = "W"},
    "$C$", 4 + 3*i, {pos = "E"},
    legend, -6.5 - 6.5*i, {}
  )
end

local addcase = function(
    xvpmin, xvmax, yvpmin, yvpmax,
    paths,
    legend
)
  graphview:Saveattr()
    graphview:Viewport(xvpmin, xvmax, yvpmin, yvpmax)
    graphview:Coordsystem(-7, 7, -7, 7)

    drawdiag(paths, legend)
  graphview:Restoreattr()
end

------
-- Tracé de 4 cas.
------
addcase(
  0, 4, 0, 4,
  {
    setminus(cap(C1, C2), C3),
    setminus(cap(C1, C3), C2),
    setminus(cap(C3, C2), C1)
  },
  "a...."
)

addcase(
  4, 8, 0, 4,
  {
    setminus(C1, C2),
    setminus(C2, C1)
  },
  "b...."
)

addcase(
  8, 12, 0, 4,
  {
    setminus(C1, cup(C2, C3)),
    setminus(C3, cup(C1, C2))
  },
  "c...."
)

addcase(
  12, 16, 0, 4,
  concat(path(U)[1], cup(C1, cup(C2, C3))),
  "d...."
)

------
-- Montrons le résultat de notre oeuvre.
------
graphview:Show()
\end{luadraw}

\end{document}
