% !TEX TS-program = lualatex

\documentclass{standalone}

\usepackage{../basic/main}

\directlua{dofile("../basic/main.lua")}

\begin{document}

\begin{luadraw}{name = 2-sets-intersection}
  local A, B = set(-2,90), set(2, -90)

  local lab_A, lab_B = "$A$", "$B$"
  local col_A, col_B = "Crimson", "ForestGreen"

  local polyline_A_inter_B = cap(path(A), path(B))

  local lab_A_inter_B = "$A \\cap B$"
  local col_A_inter_B = col_A .. "!50!" .. col_B

  local col_A, col_B = setcol(col_A), setcol(col_B)

  local graphview = graph:new{
    window = {-7.25, 7.25, -5, 5},
    size   = {10, 10}
  }

  graphview:Fillopacity(0.3)

  graphview:Filloptions("full")

  graphview:Dpolyline(
    polyline_A_inter_B,
    true,
    col_A_inter_B .. ", line width=0.8pt")

  graphview:Fillopacity(0.3)

  graphview:Dpath(
    B,
    col_B .. ", pattern = stripes"
  )

  graphview:Dpath(
    A,
    col_A .. ", pattern = {stripes[size = 10pt, angle = -45]}"
  )

  graphview:Fillopacity(1)

  graphview:Dlabel(
    lab_A, -4 + 2.7*i, {
      node_options = col_A,
      pos = "W"
    },
    lab_B, 4 + 2.7*i, {
      node_options = col_B,
      pos = "E"
    },
    lab_A_inter_B, 0 , {
      node_options =  col_A_inter_B
                   .. "!55!black, fill = "
                   .. col_A_inter_B
                   .. "!30, fill opacity = .65",
      pos = "center"
     })

  graphview:Show()
\end{luadraw}

\end{document}
