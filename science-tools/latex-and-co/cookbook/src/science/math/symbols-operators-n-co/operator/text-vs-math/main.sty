%%%
% src::
%     url = https://tex.stackexchange.com/a/742337/6880
%%%
\usepackage{amsmath}

\ExplSyntaxOn

%%%
% prototype::
%     #1 : XXX
%     #2 : XXX
%     #3 : XXX
%
%     :action: XXX
%%%
\NewDocumentCommand{ \DeclareAcronymOperator }{ s O{#3} m }{
  \cs_if_exist:cTF { #2 }{
    \msg_error:nne { db/operator }{ command-already-defined }
      { \exp_not:c {#2} }
  }{
    \IfBooleanTF { #1 }{
      \db_operator:nnne { * }{ #2 }{ #3 }{ \text_uppercase:n {#3} }
    }{
      \db_operator:nnne {   }{ #2 }{ #3 }{ \text_uppercase:n {#3} }
    }
  }
}

%%%
% XXX
%%%
\msg_new:nnnn { db/operator }{ command-already-defined }
  {
    Command ~ #1 ~ already ~defined, ~
    '\token_to_str:N \DeclareAcronymOperator' ~ ignored
  }
  {
    The ~ command ~ #1 ~ has ~ already ~ a ~ meaning. ~
    Use ~ the ~optional ~ argument.
  }

%%%
% prototype::
%     #1 : XXX
%     #2 : XXX
%     #3 : XXX
%     #4 : XXX
%
%     :action: XXX
%%%
\cs_new_protected:Nn \db_operator:nnnn {
  \exp_args:Nc \NewDocumentCommand{ #2 }{}{
    \mode_if_math:TF { \operatorname#1{#3} } {#4}
  }
}

%%%
% XXX
%%%
\cs_generate_variant:Nn \db_operator:nnnn {nnne}

\ExplSyntaxOff
