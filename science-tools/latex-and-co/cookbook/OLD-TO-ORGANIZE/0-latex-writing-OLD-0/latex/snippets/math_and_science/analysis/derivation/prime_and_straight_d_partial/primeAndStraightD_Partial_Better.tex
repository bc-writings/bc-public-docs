% Sources : 
%    * http://forum.mathematex.net/latex-f6/en-tete-de-ds-t12933.html#p124908
%    * http://forum.mathematex.net/latex-f6/derivee-avec-un-d-droit-et-espace-t12932.html#p124930
%    * http://forum.mathematex.net/latex-f6/remplacer-des-espaces-par-autre-chose-t12952.html#p125062

\documentclass[a4paper,10pt]{article}
	\usepackage[utf8x]{inputenc}

	\usepackage{amsmath}
	\usepackage{amssymb}

	\usepackage{xstring}
	\noexpandarg % This is necessary so as to  '' \derFrac[3]{\cos}{x} ''  works.


% Power writing of total derivate
	\newcommand{\derPow}[2]{
		#2^{\left( #1 \right)}
	}

% Fractional writing of total derivate
	\DeclareRobustCommand{\dder}{
		\mathop{}\mathopen{}\mathrm{d}
	}

	\newcommand{\dd}[2][0]{
		\IfStrEq{#1}{0}{
			\dder #2
		}{
			\IfBeginWith{#2}{f}{
				\dder^{#1} \! #2
			}{
				\dder^{#1}  #2
			}
		}
	}

	\newcommand{\derFrac}[3][0]{
		\IfStrEq{#1}{0}{
			\ensuremath{\frac{\dd{#2}}{\dd{#3}}}
		}{
			\ensuremath{\frac{\dd[#1]{#2}}{\dd{#3}^{#1}}}
		}
	}

% Subscript writing of partial derivate
	\makeatletter
		\let\original@partial\partial
		\renewcommand{\partial}{
			\original@partial\mathopen{}
		}
	\makeatother

	\newcommand\addPar[1]{(#1)}

	\newcommand\partialSub[2]{
		\def\indPartial{\StrSubstitute{#2}{^}{\addPar}} % This works because xstring traits {...} like a single character.
		\ensuremath{\partial_{\indPartial} #1}
	}

% Prime writing of partial derivate
	\newcommand\partialPrime[2]{
		\def\indPartial{\StrSubstitute{#2}{^}{\addPar}} % This works because xstring traits {...} like a single character.
		\ensuremath{#1^{\prime}_{\indPartial}}
	}

% Fractional writing of partial derivate
	\newcommand{\pp}[2][0]{
		\IfStrEq{#1}{0}{
			\partial #2
		}{
			\IfBeginWith{#2}{f}{
				\partial^{#1} \! #2
			}{
				\partial^{#1} #2
			}
		}
	}

	\newcommand\partialFrac[3][0]{%
		\def\deno{\StrSubstitute{ #3}{ }\partial} % This works because xstring traits {...} like a single character.
		\def\denoOK{\StrSubstitute{\deno}{\partial f}{\partial \! f}}
		\IfStrEq{#1}{0}{
			\ensuremath{\frac{\pp{#2}}{\denoOK}}
		}{
			\ensuremath{\frac{\pp^{#1}{#2}}{\denoOK}}
		}
	}


\begin{document}
	\setlength{\parindent}{0pt}
	\newcommand{\HH}{
		\mathrm{H}
	}

	\section{Total derivate}

	$ \cos'(x) =  \derFrac{\cos}{x} (x) $


	$ f'(x) =  \derFrac{f}{x} (x)$


	$ \derPow{5}{\HH} (x) =  \derFrac[5]{\HH}{x} (x) $


	$ \derPow{n}{G} (x) =  \derFrac[n]{G}{x} (x) $


	$ f'''(x) = \derFrac[3]{f}{x} (x) $


	$ \cos'''(x) = \derFrac[3]{\cos}{x} (x) $


	\section{Partial derivate}

	$ \partialPrime{\cos}{x} (x) = \partialFrac{\cos}{x} (x) $


	$ \partialPrime{f}{x} (x) = \partialFrac{f}{x} (x) $


	$ \partialPrime{\HH}{x} (x) = \partialFrac{\HH}{x} (x) $


	$ \partialPrime{f}{x^r y^s} (x,y) = \partialFrac[r + s]{f}{x^r y^s} (x,y) $


	$ \partialPrime{f}{x^{5 + 2} y^{4} z} = \partialFrac[13]{f}{x^{5 + 2} y^{4} z} (x,y) $


	$ \partialSub{G}{f^{5^2} h^4 r} (x,y) = \partialFrac[30]{G}{f^{5^2} h^4 r} (x,y) $


	Probl√®me : $ \partialSub{F}{x^n \cdots z^r} (x,\ldots,y) = \partialFrac[N + \cdots + r]{F}{x^n \cdots z^r} (x,\ldots,y) $

\end{document}