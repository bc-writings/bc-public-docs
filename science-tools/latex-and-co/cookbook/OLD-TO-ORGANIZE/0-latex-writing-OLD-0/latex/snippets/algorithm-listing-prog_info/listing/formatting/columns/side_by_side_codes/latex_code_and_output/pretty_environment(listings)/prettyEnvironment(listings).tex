% Source : http://forum.mathematex.net/latex-f6/afficher-un-code-latex-et-son-rendu-cote-a-cote-t12327.html#p119433

\documentclass[10pt, a4paper]{article}
	\usepackage[utf8]{inputenc}
	\usepackage[T1]{fontenc}
	\usepackage{kpfonts}
	\usepackage[scaled]{beramono}% mécane avec du gras
	\usepackage[frenchb]{babel}
	\usepackage[usenames,dvipsnames]{xcolor}%pour de la couleur
	\usepackage{lipsum}
	\usepackage{calc}

	\usepackage{listings}
	\lstset{%
		extendedchars=true,
		literate={é}{{\'e}}1 {è}{{\`e}}1 {à}{{\`a}}1 {ç}{{\c{c}}}1 {œ}{{\oe}}1 {ù}{{\`u}}1
			{É}{{\'E}}1 {È}{{\`E}}1 {À}{{\`A}}1 {Ç}{{\c{C}}}1 {Œ}{{\OE}}1 {Ê}{{\^E}}1
			{ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1%
	}
% Pour les listings sans soucis d'accents (il en reste encore un peu)
%
	\definecolor{my-gray}{gray}{0.95}
%
	\lstset{%
		language=[LaTeX]TeX,
		basicstyle=\ttfamily,  
% the size of the fonts that are used for the code
		numbers=left, 
% where to put the line-numbers
		numberstyle=\footnotesize,
% the size of the fonts that are used for the line-numbers
		stepnumber=1,  
% the step between two line-numbers. If it's 1 each line 
% will be numbered
		numbersep=5pt, 
% how far the line-numbers are from the code
		backgroundcolor=\color{my-gray}, 
% choose the background color. You must add \usepackage{color}
		showspaces=false,
% show spaces adding particular underscores
		showstringspaces=false,
% underline spaces within strings
		showtabs=false,
% show tabs within strings adding particular underscores
		frame=single,
% adds a frame around the code
		tabsize=2,
% sets default tabsize to 2 spaces
		captionpos=b,
% sets the caption-position to bottom
		breaklines=true,
% sets automatic line breaking
		breakatwhitespace=false,
% sets if automatic breaks should only happen at whitespace
		title=\lstname,
% show the filename of files included with \lstinputlisting;
% also try caption instead of title
		escapeinside={*!}{!*},
% if you want to add a comment within your code
%morekeywords={???}            % if you want to add more keywords to the set
		framexleftmargin=5mm, frame=shadowbox, rulesepcolor=\color{SkyBlue},
		commentstyle=\color{link}\small,
		emphstyle=\color{blue},
		keywordstyle=\ttfamily\bfseries\color{red},
		moredelim=*[s][\color{purple}]{"}{"},
		moredelim=**[s][\color{OliveGreen}]{{$}{$}}
	}% à compléter au besoin
%
	\renewcommand*{\lstlistlistingname}{Codes sources \LaTeX}
	\renewcommand*{\lstlistingname}{Code source}

	\newcommand{\codelatex}[2]{%
		\lstinputlisting[firstline=1,caption={#2}, label={#1}]{./codelatex/#1.tex}%
	}
	
	\newcommand{\exlatex}[3][0.5]{%
		\medskip
		\begin{minipage}[h]{#1\textwidth}
			\codelatex{#2}{#3}
		\end{minipage}
		\hfill
		\begin{minipage}{0.85\textwidth - #1\textwidth}
			\input{./codelatex/#2}
		\end{minipage}
	}


\begin{document}

\section{Un exemple}

\lipsum[1]

\exlatex[0.5]{test01}{Une liste colorée}

\lipsum[2]

\newpage

\lstlistoflistings

\end{document}