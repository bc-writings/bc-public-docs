% Source : http://tex.stackexchange.com/questions/123644/referring-to-a-whole-line-of-code-instead-of-a-line-number

\documentclass{article}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{filecontents,refcount,lipsum}
\usepackage{hyperref}

\usepackage{lstlinebgrd}
\definecolor{myComment}{rgb}{0.0,0.5,0.0}
\definecolor{myKeyword}{rgb}{0.0,0.0,0.5}


\lstset
{
  aboveskip=\bigskipamount,
  belowskip=\bigskipamount,
  frame=tb,
  framesep=2pt,
  basicstyle=\scriptsize\ttfamily,
  keywordstyle=\color{myKeyword},
  commentstyle=\color{myComment}\itshape,
  captionpos=b,
  showstringspaces=false,
  fontadjust=true,
  language=Delphi,
  breaklines=true,
  numbers=left,
  numberstyle=\tiny,
  linebackgroundcolor={\ifodd\value{lstnumber}\color{gray!25}\fi},
  numbersep=5pt,
  escapeinside={(*@}{@*)},
}

\newcommand\coderef[1]{%
  $\Rightarrow$~\ref{#1}:~~%%
}%

\newcounter{lstlinereffirst}
\newcounter{lstlinereflast}
\makeatletter
\let\rc@refused\refused% See http://tex.stackexchange.com/q/32807/5764
\newcommand{\lineref}[3]{{%
  \let\label\@gobble%
  \setcounterref{lstlinereffirst}{#1}%
  \setcounterref{lstlinereflast}{#2}%
  \lstinputlisting[firstline=\thelstlinereffirst,lastline=\thelstlinereflast]{#3}
}}

\def\lst@PlaceNumber{\llap{\normalfont% http://tex.stackexchange.com/q/110187/5764
                \lst@numberstyle{\the\lst@lineno}\kern\lst@numbersep}\lst@linebgrd}

\makeatother

\begin{document}

\begin{filecontents*}{source.pas}
program FileTest;

var
  myFile: file of Integer;

begin
  Assign(myFile, 'c:/test.ext'); (*@\label{FileTest-1}@*)
  Rewrite (myFile); (*@\label{FileTest-2}@*)
  Write(myFile, 1); (*@\label{FileTest-3}@*)
  Write(myFile, 2);
  Close(myFile); (*@\label{FileTest-4}@*)
end.
\end{filecontents*}
\lstinputlisting{source.pas}


\coderef{FileTest-1} \lipsum[1]
\coderef{FileTest-2} \lipsum[2]
\lineref{FileTest-1}{FileTest-3}{source.pas} \lipsum[3]
\lineref{FileTest-1}{FileTest-1}{source.pas} \lipsum[3]
\coderef{FileTest-4} \lipsum[4]

\end{document}