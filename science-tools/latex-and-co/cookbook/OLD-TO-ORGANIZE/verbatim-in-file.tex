% Sources.
%     * https://tex.stackexchange.com/a/680355/6880
%     * https://tex.stackexchange.com/a/70720/6880


\documentclass[options]{article}

\ExplSyntaxOn

\iow_new:N \g_my_write

\cs_generate_variant:Nn \iow_now:Nn { NV }
\cs_generate_variant:Nn \str_replace_all:Nnn { Nxx }

\str_new:N \g_my_string

\NewDocumentCommand{\myExactWrite}{+v}{
  \iow_open:Nn \g_my_write {my-output.txt}
  % In my code the write might arrives much later, even in another function, hence the use of a string
  % === See that the input is not the expected one:
  \str_set:Nn \g_my_string {#1}
  \str_replace_all:Nxx \g_my_string { \iow_char:N \^^M } { \iow_char:N \^^J }
  \iow_now:NV \g_my_write \g_my_string
  \iow_close:N \g_my_write
}

\ExplSyntaxOff

\usepackage{verbatim}

\begin{document}

%%% Level 1
\myExactWrite{
Hello % This is a comment that should not be removed
    I want precisely this spacing, and I want to be allowed to use any text
}

% %% Level 2
 \myExactWrite{
 Hello % This is a comment that should not be removed
      I want precisely this spacing, and I want to be allowed to use any text, like 1 + (1*2), héhé,
 or:

 def mycode(my_variable_with_underscore="hey"): # This is a comment (with a single sharp)
     print(my_variable_with_underscore)
 or latex macros like $\array{a & b\\c & d}$. And ideally unbalanced {} but I heard it was difficult
 (maybe by replacing special tokens like \MYCLOSINGBRACE and \MYOPENINGBRACE in the final string?). 
 }


The content of the file is:

\verbatiminput{my-output.txt}

\end{document}