% Source: https://tex.stackexchange.com/a/683081/6880

\documentclass{article}

\ExplSyntaxOn

\seq_new:N \l_ngiap_stack_seq
\msg_new:nnnn { ngiap } { stackempty }
 {
  Take~or~delete~from~empty~stack
 }
 {
  You've~attempted~to~take~or~delete~from~an~empty~stack
 }

\NewDocumentCommand{\stackpush}{m}
 {
  \seq_push:Nn \l_ngiap_stack_seq { #1 }
 }

\NewDocumentCommand{\stackget}{o}
 {
  \seq_get:NNTF \l_ngiap_stack_seq \l_tmpa_tl
   {
    \IfValueTF { #1 }
     {
      \tl_set_eq:NN #1 \l_tmpa_tl
     }
     {
      \tl_use:N \l_tmpa_tl
     }
   }
   {
    \msg_error:nn { ngiap } { stackempty }
   }
 }
\NewDocumentCommand{\stackpop}{o}
 {
  \seq_pop:NN \l_ngiap_stack_seq \l_tmpa_tl
  \quark_if_no_value:NTF \l_tmpa_tl
   {
    \msg_error:nn { ngiap } { stackempty }
   }
   {
    \IfValueTF { #1 }
     {
      \tl_set_eq:NN #1 \l_tmpa_tl
     }
     {
      \tl_use:N \l_tmpa_tl
     }
   }
 }

\NewDocumentCommand{\stackshow}{}{\seq_show:N \l_ngiap_stack_seq}

\ExplSyntaxOff

\begin{document}

\stackshow

\stackpush{1}\stackshow

\stackget\stackshow

\stackpush{2}\stackshow

\stackget\stackshow
\stackget[\foo]\show\foo

\stackpop[\baz]\show\baz\stackshow
\stackpop\stackshow
\stackpop\stackshow

\end{document}