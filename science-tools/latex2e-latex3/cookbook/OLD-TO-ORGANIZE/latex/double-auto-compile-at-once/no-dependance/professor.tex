\documentclass{article}

\usepackage{xcolor}

% Source (given at fr.comp.text.tex).
%     * https://latexref.xyz/fr/Command-line-input.html#Command-line-input
\newcommand{\solution}[1]{{\color{red}#1}}

\ifdefined\forstudents
    \renewcommand{\solution}[1]{}
\else
    % We need `...` to launch a subprocess!
    \input{\detokenize{|`"pdflatex -jobname=students '\\def\\forstudents{}\\input{professor}'"`}}
\fi


\begin{document}

\begin{enumerate}

    \item First question

    \solution{First answer}

    \item Second question

    \solution{Second answer}

    \item Third question

    \solution{Third answer}
\end{enumerate}

\end{document}
