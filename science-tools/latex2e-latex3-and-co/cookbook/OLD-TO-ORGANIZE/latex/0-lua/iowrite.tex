\documentclass{book}

\usepackage{luacode}
\usepackage{xparse}

\NewDocumentCommand{\OldHelloWorld}{}{Hello World}        % OLD
\NewExpandableDocumentCommand{\HelloWorld}{}{Hello World} % NEW -- working
\newcommand{\DefaultHelloWorld}{Hello World}

\begin{luacode}
    luatexbase.add_to_callback("wrapup_run", function()
        io.write("\HelloWorld")
        -- io.write("\DefaultHelloWorld")
    end, "Post-process pdf")
\end{luacode}

\begin{document}
    Hello World!
\end{document}
