% Source : http://forum.mathematex.net/latex-f6/imiter-une-feuille-de-calcul-de-type-oocalc-t9749-40.html#p122528

\documentclass{article}
	\usepackage{amsmath}
	\usepackage{array}
	\usepackage[table]{xcolor}
	\usepackage{arydshln}
	\usepackage{xargs}

	\usepackage{calc}

	\makeatletter
		\newcount\OOocalc@cntlin
		\newcount\OOocalc@cntcol
		\newtoks\OOocalc@t@b

		\long\def\OOocalc@ifremain@lines#1\\#2\@nil{%
			\csname @\ifx\@empty#2\@empty second\else first\fi oftwo\endcsname%
		}
		\long\def\OOocalc@subst@eol#1\\#2\@nil{\addto@OOocalc@t@b{#1\\\cline{1-1}\hdashline}%
			\OOocalc@ifremain@lines#2\\\@nil{\addto@OOocalc@t@b&\OOocalc@subst@eol#2\@nil}{\addto@OOocalc@t@b{#2\end{tabular}}}}
		\long\def\OOocalc@collect@body#1\end{\OOocalc@subst@eol#1\@nil\end}
		\newcommand\addto@OOocalc@t@b[1]{\OOocalc@t@b\expandafter{\the\OOocalc@t@b#1}}
		\newcommand\edfto@OOocalc@t@b[1]{\edef\temp@{#1}\expandafter\addto@OOocalc@t@b\expandafter{\temp@}}

		\def\OOocalc@process@starting@point#1{%
			\OOocalc@process@starting@point@aux#1\@nil
		}
		\def\OOocalc@process@starting@point@aux#1,#2\@nil{%
			\gdef\OOocalc@starting@lin{#1}%
			\gdef\OOocalc@starting@col{#2}%
			\global\OOocalc@cntlin#1
			\global\OOocalc@cntcol#2
			\global\advance\OOocalc@cntlin\m@ne
			\global\advance\OOocalc@cntlin\m@ne
			\global\advance\OOocalc@cntcol\m@ne
		}
% Environnement de tableau
		\newenvironmentx{OOocalc}[3][1=1.5cm,3={1,1}]{% #1=largeur colonnes #2 = nombre de colonnes
			\newcolumntype w{>{\raggedleft\arraybackslash}m{#1}}%
			\newcommand*\alignleft{\raggedright\arraybackslash}%
			\arrayrulewidth0.4pt\dashlinedash0.4pt\relax\dashlinegap3pt
			\OOocalc@process@starting@point{#3}
			\edef\OOocalc@total@col{\number\numexpr#2+\OOocalc@starting@col-1\relax}
		%   \global\OOocalc@cntlin\m@ne\global\OOocalc@cntcol\z@
			\OOocalcfont
			\OOocalc@t@b{\begin{tabular}{%
				|>{\cellcolor{OOocalcheadcolor}%
				\global\OOocalc@cntcol\z@\global\advance\OOocalc@cntlin\@ne
				\centering\arraybackslash
				\ifnum\OOocalc@cntlin>\number\numexpr\OOocalc@starting@lin-1\relax\OOocalcheadformat\number\OOocalc@cntlin\fi}
				m{1.5em}<{\vspace{-1pt}}|*{\OOocalc@total@col}{w:}}%
				\hline
				\rowcolor{OOocalcheadcolor}}%
				\loop
					\ifnum\OOocalc@cntcol<\OOocalc@total@col\space
					\advance\OOocalc@cntcol\@ne
					\addto@OOocalc@t@b{&\multicolumn{1}{>\centering m{#1}<{\vspace{-1.5pt}}|}}%
					\edfto@OOocalc@t@b{{\tabinnerborder=2.5pt\noexpand\OOocalcheadformat\noexpand\tabtextstrut{\@Alph\OOocalc@cntcol}}}%
				\repeat
				\addto@OOocalc@t@b{\\\hline&}%
				\OOocalc@collect@body}{\the\OOocalc@t@b}
	\makeatother

% commandes pour que le contenu des cellules ne soit pas collé aux bordures du tableau
	\newlength{\tabtextstrutheight}
	\newlength{\tabtextstrutdepth}
	\newlength{\tabinnerborder}
	\newcommand{\tabtextstrut}[1]{}
	\def\tabtextstrut#1{%
		\setlength{\tabtextstrutheight}{\heightof{#1}}%
		\setlength{\tabtextstrutdepth}{\depthof{#1}}%
		\addtolength{\tabtextstrutheight}{\tabinnerborder}%
		\addtolength{\tabtextstrutdepth}{\tabinnerborder}%
		\vrule height \tabtextstrutheight depth \tabtextstrutdepth width 0pt #1%
	}
	\newcommand{\tabmathstrut}[1]{}
	\def\tabmathstrut$#1${\tabtextstrut{$#1$}}

% commandes de personnalisation
	\newcommand*{\OOocalcfont}{\fontfamily{phv}\selectfont}% police du tableau (helvetica ici)
	\newcommand*{\OOocalcheadformat}{\bfseries}% police des en-têtes du tableau (en gras)
	\colorlet{OOocalcheadcolor}{gray!40}% couleur de font des en-têtes du tableau
	\setlength{\tabinnerborder}{3pt}


\begin{document}

\begin{OOocalc}{5}[10,5]
	                         & \alignleft euro      & \alignleft dollar & \alignleft livre        & yen \\
	\alignleft euro          &                      & 1.48              & 0.89                    & \\
	\alignleft dollar        & 0.67                 &                   & \textcolor{blue}{0.60}  & 250 \\
	\alignleft livre         & \cellcolor{pink}1.12 & 1.66              & \tabmathstrut$\dfrac25$ & \\
	                         &                      &                   &                         & \\
	\tabmathstrut$\dfrac ab$ &                      &                   &                         & \\
\end{OOocalc}

\end{document}